
The KINSEI system is continuously listening on all the ip addresses of the host machine on the port specified inside the room.conf file.

In order to communicate with it, a tcp connection can be used and the following commands (only) will be accepted. Any other command will result in a generic error.

IMPORTANT: all position values must be divided by 10 to get the float number

Command:
    Direction
    command code
    Direction
    message (in bytes)
   
Room Size
    Client -> MOCA
    0x73 
    MOCA -> Client
    0x73 Xsize(2) Ysize(2) #corners(1) {corner_X(2) corner_Y(2)}*#corners
    
Entry/Exit Zones
    Client -> MOCA
    0x78 
    MOCA -> Client
    0x78 #zones(1) {zonetype(1)(Circle = 0, Polygon =1) if circle -> center_X(2) center_Y(2) radius(2) elseif polygon -> #corners [corner_X(2) corner_Y(2)]*#corners}*#zones

Number Of Persons (float number)
    Client -> MOCA
    0x6E
    MOCA -> Client
    0x6E npersons(1) (this value is an unsigned int divide by 10 to get the float number) 
 
Number Of Persons (Fixed number used by the system)
    Client -> MOCA
    0x6D
    MOCA -> Client
    0x6D #persons(1) 
	!! ERROR !! The current firmware has a bug and returns 0x6E #persons(1) 
    
Persons Position (it is independent from the number of persons but if different (fixed one) it will fallback after a while)
    Client -> MOCA
    0x64 
    MOCA -> Client
    0x64 #positions(1) {index(2) X(2) Y(2)}*#positions (when a position is not valid the index will be 0xffff) 
  
Online Check
    Client -> MOCA
    0x74
    MOCA -> Client
    0x74 online(1) (1 if online)
    
Online Sensors Check
    Client -> MOCA
    0x7A
    MOCA -> Client
    0x7A #sensors(1) {online(1) X(2) Y(2)}*#sensors
                  
Sensors Battery Level
    Client -> MOCA
    0x76
    MOCA -> Client
    0x76 #sensors(1) {Voltage(2)}*#sensors //the voltage must be divided by 100
    
Fusion Values
    Client -> MOCA
    0x66
    MOCA -> Client
    0x66 #cells(1) {index(2) center_x(2) center_y(2) value(1)}*#cells //the value must be divided by 10

!! BETA - useable only from firmware july2017 !!
Pixel Resolution and pixel size for the thermal map
    Client -> MOCA
    0x1A
    MOCA -> Client
    0x1A PixelNumber_X PixelNumber_Y PixelSizeInCm

!! BETA - useable only from firmware july2017 !!
Thermal map, pixel temperature (multiplied by 10 and trunced)
    Client -> MOCA
    0x1B
    MOCA -> Client
    0x1B #PixelNumber(2) {pixeltemp(2)}*#PixelNumber
                                    
Error generic
    MOCA -> Client     
    0x65
